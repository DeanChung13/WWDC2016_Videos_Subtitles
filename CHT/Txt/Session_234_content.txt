ResearchKit有何新特性？
早上好
早上好
謝謝
歡迎今天來此的醫生兼編碼員
和從事研究工作提供偉大研究應用的開發人員
當然 包括今天在此的學生
我知道他們已在用ResearchKit
歡迎你們所有人
你們想看到一款偉大的ResearchKit應用嗎？
是的
好 我很高興在昨晚的派對後至少還有部分人清醒着
Duke Medicine的Autism & Beyond
是的 我們有Duke開發商在此所以 謝謝
Duke Medicine的Autism & Beyond
是旨在識別和理解兒童發展風險的研究
在ResearchKit應用
一個年輕的孩子觀看視頻
前置攝像機記錄他們的反應
讓我們一起來看看
有一隻蜘蛛爬上水管子
應用程序分析了孩子的情緒反應的視頻
提取面部表情
有一天 這樣的視頻可能會被使用
在她自己的家的孩子的自閉症
和其他心理健康的問題 如焦慮
如果研究成功了
Duke將能夠使用科學爲基礎的工具幫助家長瞭解
支持孩子的成長
我認爲這是很神奇的
它只是去年開發的許多應用程序之一使用ResearchKit的應用
今天 我和同事Yuan Zhu希望我們可以激發你們
創建另一個同樣偉大的ResearchKit應用
今天我們將ResearchKit新特性
我們將談一點
從開源社區以及你如何貢獻
但首先我想先回顧一下ResearchKit
一年多前推出ResearchKit
其目的是採取基本臨牀研究的組成部分
並將他們轉移到移動世界
這些基本組成部分都是需要知情同意
調查任務和主動任務
考慮到iPhone的數量很驚人
在世界範圍內 像你我這些用戶可以研究做出貢獻
但有一些顯著的差異
臨牀研究和移動世界
特別是在臨牀研究
參與者就在那裏
研究人員可看到並告訴他們要做什麼且和他們在一起
所以當你移動到移動空間有一些事情要考慮
我想每個組件並向你展示ResearchKit怎麼工作
知情同意
知情同意是必要的對於所有使用人類主題的研究
研究人員需要告訴參與者是什麼研究
他們要收集的數據他們將如何使用這些數據
他們將如何確保隱私怎樣的人可以拿走研究
和許多其他事情
所以通常像在Autism & Beyond研究中的人
會得到這樣的一個內容
這是相當長
因爲如果你把它端到端的它會比我高
所以這是一個很多人需要通過文本
所以這個叫做ResearchKit
我們開發了一個知情同意書模塊
我們所做的是把這個大的形式分割成一系列的屏幕
在每一個屏幕上它描述特別部分
給出了一個概述提供了一個學習更多的鏈接
若參與者希望的話 他們可以向下鑽並獲得更多的信息
他們可以在這裏撤回信息
然後在一切結束時都被放到一起給出最後的評論
然後用戶可以決定參與研究與否
如果他們決定參加這項研究
然後他們會被要求提供他們的名字簽署電子同意書
正如我們最有名的用戶Johnny Appleseed在此做的
現在我想指出的是
若你是一個開發人員做第一個ResearchKit應用
你不能只是在這裏剪切和粘貼本文Duke或者其他研究擁有的
知情同意書文本批准
通過一個機構審查委員會或倫理委員會
你需要使用他們給的文本
而你也必須抵制成爲一個有創造力的作家的衝動
而且喜歡 你知道我看這些東西和思考
我可以簡單地說我可以讓這個變成非常激動人心的閱讀
但你不想這麼做
你想得到研究員給你的東西並確保它已被批准
這就是知情同意書
在臨牀研究中
研究人員通常有一個參與者
至少做一個調查 如果只要求人口數據
但這也是很常見的研究使用像這樣的標準調查
病人健康問卷或PHQ-9
現在很容易將一篇書面調查變成一個移動的調查
ResearchKit試圖使這一點更加優化
在大多數情況下 每一頁有一個問題
當然 我們可以支持任何書面調查
比如填空 多項選擇
但因爲移動ResearchKit可以做的更多
你可以選擇
它可以有一個真正的滑動在那裏你必須滑動你的手指
你可以位置作爲一個答案或日期和時間或圖像
ResearchKit有許多豐富的回答格式
好 日期現很適合我
所以這是我們的調查任務
現在活躍的任務
在臨牀環境中的參與者可能被要求做一些事 像散步
因此研究人員可以觀察他們的步態
或者解決一個難題或講一個故事作爲心理學研究
甚至他們可能被要求做的事情如需要精細動作協調
在臨牀上有人來告訴你怎麼做
並確保你做的正確
所以我要告訴你兩個任務這樣你才能知道
ResearchKit如何處理主動任務
首先是一個語音任務
這裏的參與者被要求對着麥克風說“啊”
然後應用程序收集音頻
並以任何適合於特定研究的方式分析
因此本課題的所有組件可以在一個主動任務
讓我們通過他們
有一個頁面描述任務是什麼
這給用戶說明如何執行任務
很多主動任務有一個倒計時
然後反饋給用戶
在這種情況下 這是說她太大聲了
這樣可以確保你正確地完成這項任務
所有你看到的屏幕 動畫該屏幕導航
都由ResearchKit提供
爲得到該任務 只需使用ResearchKit 就這麼簡單
這裏還有一個任務
這是一個點擊速度的任務用戶需要來回地敲
在一個給定的時間內以最快的速度
但ResearchKit也有許多其他的任務 包括行走任務
空間記憶任務 還有其他一些
所以這些都是主動任務
從ResearchKit發佈第一天開始
就與HealthKit合成
它很容易在Xcode添加HealthKit的權利給應用程序
它不需要太多的代碼行得到這樣的屏幕
在那裏你可以詢問用戶要獲得在HealthKit的數據
當你這樣做時你需要指定所要的數據讀和寫的健康應用程序
用戶可以選擇提供你所需要一切的權限
或者她可以給你特定的許可
所以我建議當你要請求訪問數據的時候
你只詢問絕對在研究中使用的數據
所以不要請求一切
你將更容易得到用戶的許可
過去一年間我們被問到的大問題之一是
ResearchKit對數據做了什麼及數據存放何處
這對我來說很容易回答因爲ResearchKit不對數據做處理
若你出席去年的ResearchKit演講
John Earl解釋的ResearchKit架構
他還談了很多結果對象
簡單地說
ResearchKit在任務視圖控制器上有一個結果屬性
它會將該屬性的結果交給你
但取決於你的應用程序來維持本地數據
同時也爲研究將數據發送到安全服務器
在那裏你可以彙總和分析
如果你沒有看過John Earl去年的演講
我建議你去看
因爲在裏面他也展示瞭如何編碼知情同意
調查任務和主動任務
今天我不會將編碼重複一遍
因爲你們可以觀看視頻
我想邀請同事Yuan Zhu上臺
詳細介紹ResearchKit的新特性
並向你解釋如何使用它們來編碼
Yuan
謝謝你 Bunny
開源社區發現移動研究需要更多的特性
與研究提供的相比
我們一直與社區合作
爲ResearchKit添加更多特性
所以今天 我真的很興奮向你們展示三個特性
首先 分支任務
在書面上可能會費解
但在移動設備上這是真的爲用戶而設
第二 應用程序訪問
它保護用戶的隱私和數據
這對於大部分的研究應用很重要
最後 圖表
以視覺方式將數據呈現給用戶
然後你的用戶可以更好地理解數據
首先 我要談談第一個分支任務
你的應用程序是否給予指示
提出一個調查或運行主動任務
一切在ResearchKit是一個步驟的集合
共同構成一個任務並可以將任務提交給用戶
有了這個模型創建一個線性任務相當簡單
但分支任務如何創建卻沒那麼明顯
讓我給你展示一個例子
你在這裏看到的是一項有三個問題的調查
顯然 問第二個問題是有意義的
對於回答“是”的用戶
回答第一個問題 你有車嗎
以及最後一個問題你擁有自行車嗎？
應該是最後問
無論前兩個問題答案如何
你可能想知道我是如何在ResearchKit創建這項調查
爲了幫你 我給你介紹一個新類
ORKNavigableOrderTask
因爲這是一個任務所以它有一系列步驟
但除此之外 它還擁有集合導航規則
導航規則定義了任務中的分支邏輯
下一步我要向你展示如何使用這個新類
來呈現調查
它真的很容易使用
在代碼中 首先我需要創建問題的步驟
一旦我有問題的步驟
我可用這些步驟創建可導航的命令任務
正如你所看到的這和創建一個線性任務一樣容易
但之後 我需要爲它創建導航規則
我想在此創建的導航規則
是展示擁有自行車的問題
此後緊接着是對於沒車的人
我想讓你知道導航規則有三個要素
首先 觸發步驟
它觸發了要被評估的導航規則
第二 預期的答案
對於第一個問題 我們有一輛車嗎這裏我們的答案是“否”
最後 它需要一個指定的步驟
現在你已學會了導航規則中的三個元素
閒雜讓我給你展示代碼
在代碼中 首先我用resultSelector
定位結果所在處
然後我以預期的答案爲基礎創建predicate
有了predicate後我可以創建導航規則
與目標步驟
最後 我會添加第一個問題你擁有車嗎
作爲觸發步驟
正如你所看到的
這是很容易的一 二 三我創建這個導航規則
而且任務已經準備好向用戶展示
現在你已經學會瞭如何使用分支任務
下一步 讓我向你們展示應用程序訪問
用戶帳戶是應用中管理用戶非常重要的方面
應用程序訪問提供了這項必要功能
在應用程序中支持帳戶的兩個基本操作
帳號註冊和帳戶登錄
帳戶註冊允許你的用戶登錄註冊你的應用程序
通過密碼和用戶名
註冊用戶可以使用帳號登錄
繼續參與到你的應用即使在新的設備上
這就是帳戶
你可能知道
對於大多數研究應用用戶的隱私和數據的安全性非常重要
爲了幫你做到這點我們建議你的應用允許用戶
設置一個密碼[聽不清]
然後使用它來解鎖你的應用程序
這裏有兩個基本密碼運算
首先 創建密碼
它讓用戶選擇理想的密碼
一旦密碼被創建然後應用可以幫助用戶
輸入正確的密碼進入應用程序
使用密碼認證
現在你們已經學會了應用程序訪問有兩個部分 帳戶和密碼
首先讓我向你們展示帳戶
這是帳戶註冊的截圖
它讓用戶通過提供郵箱地址來註冊你的應用
兩次輸入 避免輸錯
下面 我將向你們展示如何編寫此代碼
我只需創建一個步驟ORKRegistrationStep
具有標識符 標題和文本
最後一個參數選項可以用來提供
額外的輸入字段如性別或出生日期
這一步一旦完成我可把它放入任務並展示它
步驟完成後
我需要從對象結果裏檢索用戶名和密碼
這很容易
我只需使用預定義的標識符來獲取它們
一旦我有了用戶名和密碼
我可以安全地將其發送至遠程服務器
創建用戶帳戶
這就是帳戶註冊
接下來 帳戶登錄
對於已註冊用戶想繼續使用你的應用
在這裏可以看到一個帳戶登錄截圖
它允許用戶通過用戶名和密碼來登錄
此外 如果用戶忘記他的密碼
在底部有一個按鈕
我們只需幾行代碼就能在你的應用中創建這個
同理我們要一步ORKLoginStep
我通過標識符、標題和文本創建這一步
你可能注意到我需要提供一個ViewControllerClass的最後一個參數
爲什麼？
因爲我需從ResearchKit中將視圖控制分子類
提供我自己的自定義忘記密碼行爲的處理程序
萬一用戶忘記密碼 點擊那個按鈕
我這樣做之後
然後該登錄步驟就會呈現
現在我展示帳戶註冊和帳戶登錄
接着 讓我展示你的用戶如何創建帳戶
創建密碼 然後用它來解鎖你的應用
在密碼創建過程
用戶將被要求先輸入密碼
然後確認該密碼
（可選）若設備已啓用Touch ID
用戶之後可選擇使用Touch ID來解鎖你的應用
在這裏看到幾個步驟但在代碼中 很容易做到
同樣 我需要一步ORKPasscodeStep
創建之後我建議你爲用戶提供解密文本
解釋設置密碼的目的
這就是我需要做的一切
你們中的一些人可能想問
密碼被存儲在哪裏
好問題
讓我來展示一下
從這個圖表中 你可以看到
密碼被存儲在iOS的鑰匙鏈因此是安全的
也告訴你密碼編寫和密碼讀取
都由ResearchKit管理因此你根本不需要擔心
是不是很酷呢？
-是的-謝謝
學會這個後讓我展示一下密碼身份驗證
密碼認證允許用戶
輸入正確的密碼在訪問該應用之前
讓我給你們展示代碼
我只需要一個視圖控制器
我可以很容易地創建該視圖控制器
我也需要記住最後給它指派一個代理
接下來我將展示如何實踐此代理
密碼認證的視圖控制器代理
給開發者提供了機會
處理可能身份驗證的不同結果
例如 如果密碼認證成功
我可將該功能呈現給用戶
但如果密碼驗證失敗
我要顯示警報
或是取消密碼認證
我可向用戶顯示默認的歡迎屏幕
所以就是這個代理
而且這個新控制器已準備向用戶顯示
現在我已經向你們展示了應用程序訪問的所有部分
我希望你們覺得有用
我可以給你們看看圖表
有了圖表 你可以向用戶呈現你的數據
在ResearchKit中有三種類型的圖表
從這些截圖中你可以看到
有餅圖 線圖和離散圖
讓我們將第一個放大 餅圖
餅圖[聽不清]環並且分爲段
其中每一段代表整體的一部分
每一段都有其自身的數值 顏色和名稱
一旦你學會了餅圖的基本知識
我可以向你們展示其背後的代碼
要編寫代碼 首先我需要創建pieChartView
然後我將分配一個數據源對象給它
因爲數據源對象提供圖表中
顯示的所有信息
現在我需要實踐這個數據源
但在我提到這些函數前
首先我需要花一些時間建立數據對象
爲了做到這些我首先定義一個基本結構
攜帶圖表中每一段的基本信息
從這裏你可看到我用標題 數值和顏色來定義基本結構
所有需要的基本信息
完成後 我可用那些結構創建數據對象
接着 我會把它們放回函數裏
因爲我已經準備好了這些對象
我可以很容易地創建函數
首先 我返回段的總數
然後我返回每段值
和將計算環中比例使用的值
之後是顏色和標題
完成後
然後這個餅圖就能顯示了
現在你們已學會瞭如何使用ResearchKit創建餅圖
線圖和離散圖的使用很相似
你只要上GitHub網站就行下載我們的簡單項目來學習
你可以看到屏幕上的URL
分支任務 應用程序訪問和圖表是三個新特性
今天我向你們介紹的
有了它們 我相信你會發現做一個研究應用程序將更容易
現在再次有請我的同事Bunny
談論對ResearchKit作出貢獻
ResearchKit如此多新特性的原因是
是因爲我們的開源社區
我們的許多貢獻者今天在這裏我想感謝他們
但任何人都可以和我們一起工作讓ResearchKit更好
讓我來告訴你如何實現
對ResearchKit作出貢獻
就像對任何其他開源項目作出貢獻一樣
去我們的GitHub報告
選擇或打開一個問題請給我們留言
讓我們知道你在做什麼
然後提交一個拉出請求
Apple的工程師和活躍ResearchKit社區成員
將看看你的代碼
毫無疑問 他們會有一些關於如何改進它的建議
所以我們想讓你和審查團隊一起工作直到每個人都滿意
然後你的修改會被合併進入主分支
有時我們會分支合併
在那個時候你的代碼將被本地化成iOS支持的所有語言
可訪問性的更新
並各種設備和方案上得到測試
我們也會從隱私和安全角度看你的代碼
現在這個開源過程對你而言可能有點以Apple爲中心
但我們要確保你的代碼可以在世界各地使用
被不同能力層面的用戶使用
在一系列設備上使用
所以現在你們知道如何貢獻
你們中的一些人可能已有貢獻的想法
其他人也許還沒有所以我想給你們一點靈感
但在我做此之前我們先在某個點標記一個新的穩定版本
我們的最後一個穩定版本是一月標記的Win.3
好的 你能做什麼貢獻？
當然你能貢獻主動任務
我已經展示了一些
今年我們已經有了一個NHPT測試
我要感謝Julian Therrier爲此作出的貢獻
這個任務應該是一個數字版本
在診所爲康復醫學做的一個測試
測試上肢功能
現在 這項任務正在進行研究的驗證
因爲我們不知道這個數字版本是否
與診所的版本等效
所以驗證是非常重要的
當你開發一個新任務
研究人員想知道你所說這項任務測量的對象
確實是這項任務測量的對象
因此你可能需要參與驗證研究以證明這點
河內塔是心理學研究中常用的一個難題
我要感謝James Cox對此的貢獻
我相信還有很多其他任務
事實上 研究人員經常給我寫信
並說他們喜歡 比如Stroop
這是顏色測試或精神運動警覺任務
所以若你問研究人員你會發現還有很多其他任務
我相信你們能開發這些任務
我確定除了ResearchKit還有許多其他答案格式
我要感謝Quintiles給我們位置答案格式
正如你們從Yuan這裏獲得的信息
ResearchKit的基礎就是一步
總有更多的步驟有待貢獻
我想再次感謝Quintiles貢獻了等待一步
這一步已證實是非常重要的
當你在做一個非常冗長的計算時
你想把結果給用戶
在他們繼續任務中的其他步驟之前
功能模塊封裝件有助於研究人員
Yuan剛向你們展示了圖表模塊
這是一項偉大的貢獻
感謝Ricardo Sanchez和James Cox爲此作出的貢獻
幾乎每個新ResearchKit應用都使用該模塊
事實證明 用戶喜歡看圖表
獲取他們的研究數據和進度以及有關研究的東西
條件的遺傳學基礎是許多研究人員的興趣所在
現在有兩個關於遺傳學的ResearchKit應用
PPD Act正在尋找婦女產後抑鬱症的遺傳基礎
MyHeart Counts最近增加了遺傳因素
以便他們研究遺傳學中的心血管健康
事實證明 若你想收集某人的遺傳物質
有一個知情同意的過程
這超越了你的應用程序所需
因此我想感謝23andMe
提出ResearchKit模塊展示瞭如何做...
在知情同意的情況下
而現他們在自己的網站上放着
若你想用23andMe收集遺傳數據
你可以去他們的網站獲取這個ResearchKit模塊
很棒的是他們有完整文檔
記錄如何將該模塊添加到你的應用
以及你的應用中需作出的調整
爲了確保該模塊順利運行
我肯定還有其他你們可以貢獻的模塊
正如之前提到ResearchKit不用你的數據做任何事
所以你需要將它連接至數據服務
若你是提供數據服務者
我建議你下載我們的示例ORKSample
對其進行修改並使用你的數據服務
然後在GitHub repo上放置調整後的應用
人們可以去那裏看看
如何將自己ResearchKit應用連接到你的數據服務
這將對研究人員有很大的幫助
那些正努力試圖把這些數據連接到服務器的研究人員
所以在你已貢獻出這些代碼後也許你想做更多的貢獻
我可看到你們中的一些人
若你最近去過ResearchKit.org
你會看到我們將一些教程置頂
一些開源社區寫的教程
具體地說我要感謝[聽不清]在法國的博客
與Raywenderlich.com網站
我們喜歡看到開發者教其他開發人員如何編寫代碼
如果你是這稀有的羣體之一知道如何編寫代碼和寫教程
請在ResearchKit找個你認爲需要解釋的主題
寫一個教程然後告訴我們 我們會幫你傳播
現在ResearchKit社區一直忙於寫作 Apple亦如此
我們已經更新了ResearchKit編程指南
以及今年早些時候的參考文檔
我們還爲iOS Human InterfaceGuidelines增加了一個章節
指導如何寫一個好的ResearchKit應用
如果你還沒有讀過 請儘早閱讀
我有一些作業佈置給你們
這是你們的行動號召
若你還沒下載ResearchKit框架 請今天下載
你會獲得Yuan提到的所有偉大的新特性
在框架內 你會看到樣本文件夾
在那裏面有個ORKSample應用我們今年補充的
我建議你構建並運行它這是一個很好的應用
在Swift裏
它不僅對Swift和ResearchKit使用最佳實踐
而且對於iOS也如此
對於ResearchKit應用它有很大的體系結構
你甚至可從那個應用開始
你的研究將會有一個很好的開始
另外構建和運行ORKCatalog應用
正如其名字所暗示它是ResearchKit功能目錄
當你運行它時你會看到每個主動任務做什麼
你會看到所有的答案格式
你甚至可以看到資格調查是什麼樣的
最後 請做出貢獻
ResearchKit是開源的它將變成什麼取決於你對它做了什麼
開始ResearchKit所需的一切
都在這頁上developer.apple.com/WWDC16/234
有GitHub repo的鏈接
教程的鏈接 文檔的鏈接
所以請看看吧
今天下午我想你們來參加“開啓CareKit”的演講
CareKit是一個新的開源框架我們在3月份推出
這將幫助你建立好的應用爲人們管理自己的護理
所以 謝謝大家希望各位在餘下的WWDC過得愉快