WALLET和APPLE PAY的新功能
大家好！
再次致意參加了上一場演講的大家
感謝大家的停留
也向新來的成員以及下面的每一位問好
當然還有在線觀看的大家
我是Nick 這是我的同事Leo
我們將介紹Wallet和Apple Pay的新功能
首先我們要升級下Wallet
再一起討論下
關於銀行和零售商的新增功能
然後是WatchKit
可以使用Apple Pay了
不僅是在Apple Watch商店支付
還可以在WatchKit應用中
現在讓我們看看最激動人心的地方
就是在iOS Siri地圖和信息上的延伸
這些新延伸點都能使用Apple Pay
最後就是你們一定會喜歡的新東西
測試Apple Pay和全新Sandbox環境
我們開始吧
PassKit的新功能是什麼
希望你們會發現Wallet不只是Apple Pay
還有pass
現在是開始使用pass的好時機
因爲Apple PayWallet用戶越來越多
越來越多的人註冊使用Wallet應用
這裏 我們沒有時間運行整個pass系統
但我們可以提供一些資源
我會簡單介紹下 僅作提醒
別擔心 只是一點
Pass讓你拿到禮品卡 登陸證
回饋卡 活動券 會員卡或者其他
直接在用戶的iPhone或Apple Watch中
你可以使用多種方式進行分發
例如應用 郵件
SMS iMessage網絡連接或者二維碼
這些pass可以進行遠程升級
這些升級顯示在用戶的鎖屏上
例如像機票日期更改或其他相關
如果你在商店附近pass會進行關聯
並顯示在鎖屏上
我們有一場關於pass的演講可以提供更多的信息
是去年的演講請前往Apple Pay主頁
在developer.apple.com有許多資源
讓我談談幾個新變化
經過去年一年做的改變
大家可能沒有注意到的
一點就是應用的位置
在iOS9.3 我們對pass設計做了一點改變
應用放在pass前面
這些應用圖標可以直接鏈接你的申請
如果你有品卡pass 希望爲用戶
便捷完成補充禮品卡這類事情
或是航空公司 你希望在應用獲取
更多航班信息
添加也很簡便
你只需將該pass添加到你的pass 應用ID
如果你想 可以深層連接
iTunes的Adam ID和URL方案
去年我們也介紹了一種新pass
增值服務pass
這樣pass可以通過NFC安全傳遞信息
例如積分卡信息
如果你在美國可能已經使用Walgreens Pass
就以在NFC傳遞
增值pass在過去一年發展迅速
延伸許多銷售系統點
Verifone Ingenico和許多其他製造商
支付終端支持該協議
還有些你們不瞭解的增值服務pass功能
它們也支持一鍵體驗
有點類似於這樣
你把手機放在支付終端
將支付信息
和積分卡信息一鍵傳遞
深度整合進購物過程中
這也適用於Apple Watch
現在增值服務pass也可以在NFC流通
甚至可從Wallet的NFC直接分發的
pass註冊積分計劃
進行分享和個性化
現在你可以在這兒註冊積分計劃
現在有一些關於增值服務pass的注意事項
你可能發現了其中之一就是
這些pass需要不同的證件進行簽字
常規pass使用
你在開發者門戶創建的證件
但增值服務pass需要
使用NFC簽發證明
現在你需要申請這些證明
你可以聯繫我們瞭解更多信息
演講結束我會顯示鏈接
這樣你們可以前往瞭解更多
關於使用增值服務pass的信息
我們在研究室有一些工程師
演講結束後有個研究室
若有任何疑問歡迎前往
我們很樂意解答
讓我們來談談PassKit的其他新特性
現在這些是關於髮卡方但我覺得很有趣
即使你不是髮卡方
也會感興趣的
我們爲使用Apple Pay髮卡人提供專有功能
我們也支持商店信用卡和借記卡
這是Kohl的卡
如果你有商店卡就可以添加
這些不僅用於銀行也用於零售商
最大的功能是應用配置
我們去年添加了該功能
而有些應用已經採用了
Discover就是其中之一
可以直接在自己應用設定Apple Pay卡
不需要離開應用打開Wallet來打開首選項
適用於Apple Pay的所有現有髮卡人
現在API紀錄在developers.apple.com
你也可以聯繫我們瞭解更多信息
演講結束後我們會顯示郵箱地址
我們在研究室也有能幫助你的工作人員
我們有新的按鈕風格
你可以用於添加卡
和常規pass
如果你只是pass開發人員
你能使用新的PKPaymentButton風格 像這樣
我有幾個代碼顯示如何在1分鐘內運行
現在介紹iOS10中
髮卡人和零售商的專有新功能
它們可能有資質或者聯名卡
或是跟銀行有合作關係
讓你感受全新的店內體驗
你能從應用直接出示卡
這樣的好處就是
你可以在應用中兌換優惠券
然後立馬用於支付
也許你的應用可以使用iBeacon
完成一次完美的店內體驗
像這樣你進入商店 在應用兌換優惠券
你只需要按鍵
就能立馬使用Apple Pay
卡就在你的應用中
再簡便不過的使用API就在Pass Library
你能將全新PKPaymentButton風格
用於品牌一致性
這就是.inStore風格
我們另一種風格就是剛剛展示的
添加進不同分類這是Add to Pass Button
請看文件獲取更多信息
另一個有趣的功能就是
將你的申請關聯到卡
再一次大大方便了零售商和聯名卡
持有人或與髮卡行有合作關係的用戶
你可以關聯應用到商店或者程序卡
這意味着如果用戶希望可以違約
這是你拿到VAS pass的界面
跟支付pass的一樣
當通過NFC支付時可以進行銀行卡違約
或者在新的iOS10在支付申請時可以違約
要是你發揮Apple Pay的網絡優勢
通過網站時也可以
現在關於這點最棒的是不需要API
在以卡自身爲基礎建立的
你要做的就是在pass下載應用
獲得Adam ID和URL方案添加到設備
爲達到該目的 你可以聯繫髮卡行
而髮卡行則可以通過演講後的聯繫
方式找到我們
或者在研究室找我們
以上就是PassKit的新功能
下面我想說說Apple Pay和它的新功能
我想告訴大家Apple Pay怎麼運作
它是一種簡便 安全 私人的支付方法
可用於商店和應用中
取得了很高的客戶滿意度
在支付方法中獲得了最高的客戶滿意度
現在Apple Pay可以在應用中使用
你可以在應用中直接使用Apple Pay
全球各地上千個應用已經採用了
比如Apple Pay在美國 中國
最近已經在 爲法國 澳大利亞做準備
在許多國家都支持Apple Pay
數百萬用戶正在使用
Apple Pay的增長令人驚喜不論是在商店還是應用中
像你們一樣的開發人員已經看到成果
我想要說說兩個應用
一個是Chairish
當Chairish應用使用Apple Pay後發現
它們的轉化率比其他付款方式高三倍
這是個驚人的增長
我想沒有其他付款方式能達到這樣的效果
而它們的iOS應用中的StubHub
發現相比其他支付方式
Apple Pay驅動兩倍新用戶
所以不僅作用於現有客戶
Apple Pay還能帶來新用戶
Apple Pay應用往往在應用商店中顯目突出
我們常常進行Apple Pay應用的促銷活動
已經收到一些喜人的成果
在已經開發的新國家中
我想簡要談談中國
在中國有一些很棒的應用程序
幾個月前我有幸前往北京
教一些開發人員使用Apple Pay
也取得了很好的效果
Apple Pay在中國全面支持中國銀聯的信用卡和借記卡
而CUP也接受Apple Pay API
包括China Union Pay PayEaseLianlian Pay YeePay和UMS
這些都是主流的中國支付方式
我們也準備中文版的連接指導
和入門指南
它們也有法語版
現在我們正在開發法國市場
你可以查看我們開發網站的鏈接
現在讓我談談API的新變化
如果你已經開發Apple Pay
你應該會喜歡這點
從前Apple Pay的問題之一就是需要預先設置網絡
你需要告訴我們用於支付申請的網絡
再 將其編碼入你的應用程序
很難添加新的網絡
你必須執行SDK可用性檢查
確保一直可用
或者試圖進行破解 這可不推薦
對於擁有Apple Pay應用的用戶
可能會記得我們在Apple Pay推出Discover
在去年 除非升級了你的應用
否則使你的支付處理器接受你也無法接受
所以我們在iOS10中引入新的功能解決這一問題
就是動態網絡和代理服務器
首先在PKPaymentRequest添加新的類方法
可以識別設備可用的所有網絡
即PKPaymentRequest可用網絡
還有其他的改變
你可以設置付款流程
視支持網絡而定
而這些代理連接到其他網絡
例如 我的付款流程支持Visa MasterCard AmEx
這裏可用我只要把它們連接到支持的網絡
就可以自動獲取網絡
最重要的是 可以連接到新網絡
要做的只是將它們添加到Apple Pay
你可以登陸我們的開發網站獲取
相關的付款流程信息
這個功能最棒的是可以省去
編寫Apple Pay應用程序的苦惱
另一個我想說的改變是Swift 3
也許你們已經發現其中的重大改變
我們已經改善Swift用戶的API
實際上我們完全重寫了示例代碼
這個一會再說
即將發生的改變
沒有在一號方案中生效但在二號生效
PassKit現在使用多字符枚舉
可能你還不確定那是什麼這是Swift
將符串常量變爲枚舉的方法
該方法大大簡化了Apple Pay的開發
讓我們整體看下Apple Pay
今年我們有三大新目標
在Apple Pay添加支持
我們往WatchKit應用添加WatchKit支持
我們往iOS新拓展添加支持
最後是向Safari添加
在MacOS Sierra和iOS 10上
上場演講我們討論了Safari
已經可以在線查看 大家可以去觀看
今天讓我們關注WatchKit和擴展
我首先想談談WatchKit
告訴大家它是如何簡便地
將Apple Pay整合入Apple Watch
我想讓WatchKit團隊的Leo介紹
Leo
謝謝Nick 大家好
我是Leo 來自AppleWatch團隊的軟件工程師
很高興能跟大家分享在今年我們對於Apple Pay在watch上的應用所做的成果
我們在WatchKit應用添加支付支持
這會在watch生成
全新的應用種類
對開發人員是個好消息
如果你已經在iOS應用上使用Apple Pay
同樣的代碼將用於watchOS幾乎沒有改變
讓我們看看如何進行覆蓋
首先我們要快速回顧下支付工作如何在平臺工作
我將給大家展示如何創建支付申請如何製作支付表格
然後做一個快速演示
你就知道Watch上的Apple Pay有多簡便
最後 我們來談談設計注意事項
在爲watch特別設計時大家要謹記
這是用戶熟悉的iOS Apple Pay體驗
現在來看看watch
大家注意到用戶界面很簡潔
我們只是在頂部顯示金額和商家名稱
用戶只需雙擊側邊按鈕就能支付
如果想進行更改或查看信息
可以向下滾動
他們可以訪問不同的支付卡
快遞 計費和聯繫方式
在準備付款時他們可以
查看支付費用的詳細信息
只需雙擊測按鈕就能完成
就是這麼簡單
現在讓我們從開發者角度看看
支付如何進行
跟iOS上的流程一樣
首先創建一個支付申請
然後傳送到支付授權控制器
這就是平臺上驅動支付表格的對象
根據用戶與UI的交互我們將調用你的委託
例如 支付方式或者送貨地址
你可以利用這個機會進行驗證
例如 你並不需要將產品運送到其他國家
或者你想要在UI更新下運費
和總金額
用戶確認支付後
我們會訪問Apple服務器裏的安全元素
併發出付款標記 用於處理付款
現在 在進入代碼前 簡短的說明
在應用使用Apple Pay還需要一些設置
首先 你需要前往開發人員門戶註冊商家身份和證書
你可能已經在iOS應用上完成了
然後你需要在WatchKit擴展中分別啓用Apple Pay
在我們網站上有分步說明
現在我們看看代碼
這就是如何創建支付申請
我們使用與iOS同樣的PKPaymentRequest對象
你創建一個並設置國家和貨幣代碼
你的商家身份
你支持的支付網絡同步能力
然後指定項目列表描述用戶付費目的
謹記列表中的最後一項顯示總金額
我們推薦你使用商家名作爲商標
原因是我們會在支付表格上方顯示
當你想要製作支付表格時
你創建PKPaymentAuthorizationController
應剛纔創建的申請進行傳遞
然後將自己或其他對象作爲委託
你只要進行編碼
現在 因爲你正在出具支付表格
你還需要負責取消 確保
在我們前往代理付款授權控制器DidFinish時取消
這樣PKPaymentAuthorizationController
這是在PassKit結構提供新的控制器類
負責控制付款授權流程
有同樣的API語義
即PKPaymentAuthorizationViewController
但由於不是以視圖控制器爲基礎
允許從你WatchKit擴展中出具
支付表格
支持使用watchOS和iOS
所以你可以在不同的應用和平臺
分享你的代碼
現在 讓我整合起來看看快速演示
我在咖啡店處理這個應用
用戶可以在watch上進行下單付款
這樣當他們到達店鋪的時候已經一切就緒
現在來看看我們的接口
很棒 我們的產品視圖就要完成了
現在我們只需要爲用戶添加支付方法
前往右下角的Option Library
搜索支付按鈕
當你想要製作支付表格時
我們提供可以使用的對象
我們只需拖放到我們的視圖
現在開始添加代碼
我要建立輔助編輯器
這樣我能夠並排查看代碼和UI
我要控制拖放從我的按鈕到我的接口
並創建新的動作 命名爲買
現在讓我們關注代碼
首先 因爲我們使用的是PassKit框架
要確保導入這個
現在我們顯示購買方法
這與我們之前在幻燈片上的內容相似
首先 我們要創建支付申請
這裏我們設置爲美國
我們按美元收費
我們指定註冊可用的商家身份
然後我們支持的支付網絡同步功能
最後是項目彙總列表
這裏是我們剛纔喝咖啡的總金額
現在 你想出具支付表格
我們創建PK PaymentAuthorization Controller
我們通過申請 將自己設置爲委託
調出
對於一號種子你需要在Payment Controller周圍
而支付表格是可見的
確定正在使用的狀態
之後由於要運行委託協議
進行確認
對於該工作我們必須執行
兩種要求的方法我們只要執行兩種要求的方法
第一種PaymentAuthorizationController
授權付款
當用戶確認付款時調用
我們提供傳送到付款處理器
確認調用完成處理器
所需要的所有信息
第二種 就是我之前提到過的
PaymentAuthorizationControllerDidFinish
這就讓你取消支付表格的另一個機會
並顯示訂單最終狀態
這就是我們要做的 來試試下單
好了 我們的應用
我要點擊購買Apple Pay按鈕
看到了支付表格
很簡單 我們可以試試不同的支付卡
如果你想模擬用戶操作
雙擊側按鈕
在模擬器菜單有一個新選項
在Hardware下叫做Authorize Apple Pay
只要點擊 就能完成
確認我們的付款
咖啡應該馬上就好了
這就是我們的演示
如你所見Apple Pay操作簡單
只需要幾分鐘 不超過50行的代碼
現在 結束這部分前 我想談談設計
我們是如何讓Apple Watch用戶操作簡便
也許最重要的就是思考
你想要怎樣一種watch體驗
用戶只想在幾秒內
連接到你的應用
所以提供用戶所需要的
讓他們直達支付表格
記住互動時間短 屏幕小的特點
下一步 不要申請無用信息
例如聯繫人郵箱地址
他們在iPhone上進行的結算和派送活動
是不能再在watch上重新進入的
這一點必須牢記
正如我們在演示中所說使用提供的支付按鈕
如果在WatchKit框架可用
界面生成器就支持 添加就很簡單
再參考我們網站上的指南
可能會更仔細說明支付按鈕
該如何運用在應用中
總而言之如果你有運行Apple Pay
的iOS hub大部分使用相同編碼
你只要確定運行PKPaymentAuthorizationController
使用其提供的出具和取消方法
在設計Watch的應用時
要謹記互動時間短 屏幕小的特點
根據指南使用我們提供的支付按鈕
如果你還沒看視頻我強烈推薦大家去看看去年
在Apple Pay We Announce的演講
裏面有更多關於創建此種體驗的信息
和如何通過不同方式定製支付表格
很期待大家將在Watch上
如何使用Apple Pay進行開發
現在把時間交還給Nick
他將告訴你們更多關於擴展的信息
謝謝大家
謝謝Leo
好了 說到擴展
在上一版中
Apple Pay在擴展方面表現不佳
很難支持擴展
一部分是因爲我們需要視圖控制器顯示
而不是所有擴展都以UI爲基礎
坦白說 用處並不是很多
在iOS9和iOS 8上很少有擴展點
直接添加到Apple Pay
但在iOS 10中有了改變
我們發現了新的機會
iOS10上的新擴展在Apple Pay的效果很好
已經爲Apple Pay內置支持
我們解決了無法在非UI環境
下顯示的問題
剛剛Leo在watchOS展示的PKPaymentAuthorizationController API
也可以用在iOS
你能在應用或擴展的任何位置使用
我想展示幾個使用Apple Pay的擴展
Fandango拿到我們的擴展API iMessage 應用API
用於購買電影票
也能用於其他事情你能用它進行分項和購物
給朋友送禮 組織戶外活動
所以在Fandango你可以挑選電影
和朋友一起商量 買票
我們從不留言 而是在信息中
你就完成了 太簡單了
我演示Apple Pay的另一種用法
是在Siri Maps和Intent框架使用Apple Pay
在Siri和Map上有新的分享擴展點
你可以在擴展點內使用Apple Pay
實際已經內置
這樣就可以直接從擴展支付
給大家看個小視頻
我們今年開發的示例代碼就有一個搭乘分享意圖
現在我通過示例應用向Siri預定搭乘
Siri詢問是否希望搭乘
回答是的
Apple Pay表格就會馬上顯示
輸入ID 就可以了
很簡單 我甚至不必離開Siri
停留在這兒 不必前往其他應用
也不必輸入任何的支付信息
最棒地方就是即使用戶從沒接觸過
用過你的應用 還是可以進行支付
甚至不必擁有賬戶
所以在這些擴展點進行支付申請處理
對WatchKit來說至關重要
同樣的
你可以在UI和非UI擴展點
使用新PKPaymentAuthorizationController
同時我建議你們分享自己的支付代碼
你可以擁有一個集中支付類
並在Watch iOS應用和iOS擴展進行共享
這就是示例代碼的功能
我們重寫了去年發佈的Emporium示例應用
已經在Swift 3中重寫
並進行簡化
變得更容易理解
展示了Apple Pay共享模式
其中的支付邏輯實際是一樣的
不論你使用哪種平臺
所以趕緊下載體驗
當然你可能會在體驗中遇到小麻煩
讓我進行Apple Pay測試
努力給大家帶來最好的體驗
如果你已經開發了Apple Pay應用現在就可以開始測試
你會發現有點難
你在模擬器上測試
我們已經在模擬器提供了一些很棒的新支持
你可以在Watch模擬器上看到新授權的Apple Pay Button
在二號方案中我們也在iPhone安裝了
你可以測試iOS WatchKit
甚至可以在Safari模擬器測試網頁Apple Pay
現在模擬器返回虛擬支付數據
其支付數據全部是虛擬的
沒有任何用途
只是用於UI開發和快速測試
但對於端到端的測試用處不大
並不是真實的銀行卡數據
模擬器並不代表設備的行爲
我們一直告誡 不要在開發中
使用模擬器 要在硬件上測試
但這在Apple Pay上並不總是可行
Apple Pay可用於許多國家 但不是所有國家
也許你的開發人員在國外
或者你沒有那個國家認可的銀行卡
今天就讓我們來解決這個問題
我們要介紹Apple Pay Sandbox的環境
Sandbox是一種全新的Apple Pay測試環境
讓你的臨時測試卡直接用在真實設備上
使用這些測試卡
返回的也是真實支付數據
就好像在Apple Pay使用信用卡
或者借記卡付款買東西
使用簡單 設置也很容易
你可以整合到QA環境中
之前由於生產財務數據限制
可能無法完成
Sandbox的設置非常簡單
只要在iTunes Connect
創建測試iCloud帳戶
現在你可以通過這個實現各種功能
現在已經有了
你只要在設備登陸帳戶
如果你不在Apple Pay的支持區域
你需要地區改爲美國或加拿大
這樣就能使用在developer.apple.com下發的測試卡
我們有測試號碼清單供大家使用
有類似臨時Apple Wallet常規卡的臨時卡
沒有開發人員設置或開關
環境自動開關中你有課登陸登出iCloud
現在你還可以在啓動前用生產卡驗證應用
還應該進行端到端交易
我認爲這對大家的測試來說是個
很好的環境和功能
如果你希望像上節說的那樣使用
網頁Apple Pay
開始你只能在Sandbox中測試
因爲我們直到發佈GM iOS 10纔會
推出生產卡
因此今天Apple Pay Sandbox支持三種網絡
支持American ExpressMasterCard和Visa
更多網絡會在將來加入
我們也希望將Sandbox整合進
各種支付流程中
如果你使用iOS 10就可以體驗了
現在讓我們快速回顧下今天討論的東西
我們談到新Wallet和Apple Pay API的功能
一些我們在去年iOS 10中引入幫助主開發人員 髮卡人和
零售商的新事物還說到Apple Pay和WatchKit
我覺得Apple Pay WatchKit真的很棒
等不及要試試從Apple Watch直接搭乘
卻不用拿出手機
我們還說到Apple Pay的擴展
我認爲還有很多機會感受令人信服的體驗
用戶可以進行購物卻不用前往應用
直接從Siri地圖
和信息進行
之後我們談到在Sandbox和模擬器上的測試
一件從沒提到過 今年的重頭戲
即網頁Apple Pay
這樣你不僅可以在應用擴展WebKit上
使用Apple Pay現在還可以在手機網站上使用
可以在桌面MacOS Sierra上使用
你可以在Safari授權支付
通過Apple Pay設備iPhone和Apple Watch
我們已經在前一節談到過
如果大家感興趣可以去網站查看
如果你想了解今天談到的更多信息
可以查看我們的演講網站
我承諾發佈一些聯繫方式和其他的信息
我承諾進行銀行和聯合私人品牌問詢
如果你對應用程序的配置或
聯合品牌和髮卡人功能感興趣
可以給我們郵件
如果你對增值服務pass有興趣
可以訪問我們的網站
這是鏈接developer.apple.com/contact/passkit
你可以提交申請使用增值服務簽名證書
我們有一些相關演講
像我之前說的訪問Apple Pay網頁
明天在Presidio樓上還要一場WatchKit的會話
Apple Watch的偉大設計之旅
如果你對WatchKit感興趣很值得一去
去看看如何使用WatchKit應用
特別是在watchOS3的新變化
感謝大家的到來
感謝大家在應用程序中使用Apple Pay
很期待大家將來的創造
希望我們來年再見
一起討論更多關於Apple Pay
享受 WWDC 之旅