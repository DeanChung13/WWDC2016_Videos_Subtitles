掌握tvOS的UIKit
歡迎來到“掌握tvOS的UIKit”
我是Justin我負責UIKit工作
我在這裏向你展示如何超越普通點
真正讓你的tvOS應用達到新高度
要做到那些 我們今天需要討論幾件事
首先是事件處理
你的應用將會收到什麼樣的事件
處理這些事件的最好方法是什麼
然後我們會討論分層圖片
這是tvOS獨一無二的用戶界面元素
我們將展示如何利用它
第三 我們將討論滾動條
滾動條在tvOS的工作方式與在iOS中有些不同
我們將展示如何控制滾動條
最後我們將討論文本輸入
和如何使用系統鍵盤
接收用戶的文本
讓我們開始吧 首先進入事件處理
當講到事件處理
這裏幾個全面的最佳實踐
我馬上與你們分享
第一個是當它允許你的用戶
去導航你的應用程序
並轉移焦點從一個項目到另外一個項目
你不需要寫任何你自己的事件處理程序
焦點引擎會爲你處理一起
包括處理不同類型的事件
基於用戶當前使用的輸入設備類型
它會爲你處理好一切
第二 如果你決定需要開始處理事件
我們建議你開始使用UIGestureRecognizer
不僅得到一個極富表現力的API
而且它會幫助確保你的應用裏所有的手勢和交互
將同所有系統應用和其他應用保持一致
最終 當你正在設計應用交互模型
記住並非每個輸入設備
能夠生成每一種類型的事件
例如 一個用戶可能使用遊戲控制器
來導航你的應用程序
遊戲控制器能夠生成觸摸事件
你可能不想使用觸摸事件
作爲與你應用交互的唯一方式
所以當你正在設計應用時記住這些
談到觸摸
我們在tvOS上的觸摸技術
在Siri Remote上使用觸摸表面
我們以UITouch交付給你
它是一個API你可能從iOS中認出
一次觸碰代表用戶手指
和遙控器屏幕的聯繫
這就像iOS版本
他包括位置和其他屬性
你經常使用的
這點是很重要的差別
tvOS和iOS的觸摸技術之間
iOS觸摸直接發生於用戶界面
用戶肢體觸摸UI
tvOS卻並非如此
離用戶界面10英尺遠
用戶觸摸的是其遙控器
所以我們把這些分爲兩個不同的類別
我們稱在iOS上的爲直接觸摸
在tvOS上的爲間接觸摸
我們稱該觸摸類型爲UITouchTypeIndirect
來幫助你區分兩者不同
因爲這種間接觸摸假如你問UITouch
在一個直接觸摸界面“你在屏幕上位置是什麼？”
答案顯而易見
我們提供一個位置
它能準確配對用戶手指在屏幕上的位置
但是在tvOS用戶不會觸摸屏幕
那我們會怎麼報告觸摸的位置呢？
在這情況下 我們會
無論用戶手指在遙控器上從何處開始觸摸
我們總將該觸摸傳遞至你的應用
好像它是從焦點視圖的中央直接開始的
這方法很好因爲它意味着
任何手勢識別器或事件處理邏輯
你可能已附加到焦點視圖上
將總有機會參與到手勢上
我們不能暴露的是
用戶手指的絕對位置
在觸控板上
我們爲什麼那麼做是有一些原因的其中最重要的一點是
在tvOS上我們想阻止基於指針的UI
我們不想看到一些如鼠標指針類的東西
或像它一樣的
我們真的很希望應用程序能夠堅持
我們所創建的焦點交互模型
除了觸摸
你還能在tvOS上獲得另外一種事件
它們被稱作按下
按下方法通過經典UIPress類提供
一次按下代表一個真實的硬件按鈕
用戶正在與它交互
並不是所有的這些按鈕被簡單按下或者沒被按下
比如遊戲控制器這樣的一些按鈕是壓力感應的
我們能真實檢測到用戶按下按鈕的強度
我們可以把那個信息傳遞給你
你能夠識別按下
通過UIGestureRecognizer類
包括如TapGestureRecognizer
和LongPressGestureRecognizer
我們有低級別的按下處理事件
它與低級別的觸摸處理事件遵循相同的模式
pressesBegan會觸發
一旦用戶開始按下按鈕
pressesChanged方法會被調用
若它是一個壓力感應按鈕
並且壓力值會改變
還有pressesEnded和pressesCancelled
像touchesCancelled是的 你真的必須執行它
關於這些方法 有件事需要知道
那就是按下事件以爲它們不是真的有一個位置
它們直接傳遞到焦點視圖
他們從那裏到達響應者鏈
它們不會去任何焦點視圖的子視圖
所以要記住這點 當你決定
把什麼樣的視圖附加到手勢識別器上
我們說了好多關於按下的事
讓我們過一遍按下的類型
對於你來說是可用的和什麼類型的按鈕會觸發它們
在不同類型的輸入設備上
所以我要向你展示Siri Remote
上一代Apple TV的Apple Remote
我要向你展示遊戲控制器
幻燈片上沒有空間 但是記住
按下也能夠從可編程通用的遙控器裏
和從Bluetooth鍵盤中產生
所以有很多方法得到按下
可能你最常碰到的按下類型是UIPressTypeSelect
這種按下類型代表
用戶想激活一個控制或選擇一個CollectionView單元
諸如此類
在Siri Remote上那是在遙控器觸摸表面
之下的按鈕
在Apple Remote上那是一個銀色的圓圈
在遊戲控制器上
我們使用A按鈕生成此按下類型
另外一種你會碰到的常用按下類型是UIPressTypeMenu
這種按下類型指用戶想返回
他們想釋放一個presentedviewcontroller
或甚完全釋放你的應用並返回到主界面
這三者在屏幕上 就是菜單按鈕
在遊戲控制器上我們也使用B按鈕
最後 就是UIPressTypePlayPause
這對於暫停和播放內容明顯是有用的
但是它也被用作除選擇按鈕以外的快捷圖標
所以如果用戶選中一個電影海報
按下選擇按鈕可能會展示這個電影的詳細信息
但是按下播放/暫停將直接跳轉到回放
所以這圖標有——
或者有播放/暫停圖標的按鈕
在遊戲控制器上
我們將使用X按鈕生成按下類型
爲了更完整些 這還有幾個按下類型
它們是定向按下
所以我們有上 下 左 右箭頭按下
能夠被生成
在Apple Remote上我們使用四個定向按鈕
在遊戲控制器上有好多方法去實現
所以我們將使用D pad
我們也使用定向手柄
我們甚至生成左和右的按下
在遊戲控制器上使用肩按鈕
在Siri Remote上這些箭頭不是具體的硬件按鈕
所以你可能想到在那裏生成是不可能的
但那其實是錯的
如果你做了一個觸摸點擊而非一直長按
選擇按鈕 但只是觸摸
在表面的這四個基本方位點
然後UIKit會檢測到它
將爲你生成箭頭按下
這是一個真正簡便的導航方法
一次一項目地通過你的用戶界面
只因用戶正使用Siri Remote
那並不意味着它們不能生成箭頭按下
我保證你可以用手勢識別器去識別它們
我不會詳細過一遍但是我想給你們舉些例子
你知道 我們可以使用頂端的TapGestureRecognizer
我們甚至可能長按 正如你可能這麼做
在tvOS主界面進入編輯模式
在底層我甚至可以調整所需點擊的次數
所以我現在選擇按鈕上監聽一個雙擊
好的 讓我們特別談談一個按鈕
它是菜單按鈕
菜單按鈕在tvOS上有些有趣的行爲
它似乎有兩個角色
它不僅需要在你的應用內部有用
因爲我們要做諸如釋放視圖控制器之類的事
或彈出UINavigationController
而且它還需要有系統層級的行爲
最終你的應用需要去釋放——
被釋放 因而用戶可以返回主界面
若那不可能 你的用戶將感到非常沮喪
可以想象這非常重要
這就是應用審查的特別關注點
如果你的應用程序無法退出
通過按菜單按鈕你可能無法通過應用審查
我們不想發生這事
所以這怎樣進行？
我們如何得到它以致菜單按鈕不僅
被應用程序捕獲而且可以被系統使用？
所需技術層面的
爲了你的應用能完美退出並返回主界面
是當菜單按鈕被釋放的時候
pressesEnded事件需要一路沿
響應者鏈向上若你被UIApplication接收
如果那不發生 你的應用不會退出
有時候那正是你想要的
如果你已深入到UINavigationController
用戶按下菜單按鈕
他們不想退出你的應用程序
他們只想返回到前一個視圖控制器
在那種情況下 有可能是TapGestureRecognizer
它是用於監聽菜單按鈕
如果那個識別器開始識別
它會發送pressesCancelled到響應者鏈
在這種情況下 應用不會退出
然後UINavigationController可以拋開視圖控制器
不總髮送pressesEnded到你的應用是可以的
你只要確認這是可能的
當它出現在一個合適的時機
所以正確的做法是
我們強烈建議你從手勢識別器開始
當你不再對處理菜單按鈕感興趣時
你需確保GestureRecognizer已移除
一種做法是從視圖中移除GestureRecognizer
同時禁用手勢
手勢識別器有個屬性叫做已啓用
如果你把值設置爲假然後手勢將被禁用
如果你不想那麼做
這裏有UIGestureRecognizer delegate API叫做gestureRecognizerShouldBegin
你可以執行它然後對於每個菜單按鈕的按下
你有機會在那刻決定
是否想處理手勢
如果你正執行低級別按下處理方法
在pressesEnded實現中
決定你是否想處理這個事件
如果你想去處理這個事件就不要調用super
但如果你不打算處理這個事件
就確保調用super
這樣它就可以繼續沿響應鏈向上走
UIApplication有機會去接收它
最後 若你正寫遊戲
你只有一個視圖控制器是非常常見的
它是用於展示你的遊戲
所以這種情況下
你可能考慮使用GCEventViewController
它有這個屬性controllerUserInteractionEnabled
功能是
當用戶使用遊戲控制器瀏覽你的應用時
不但事件將會到遊戲控制器框架中
這框架可能你早已在遊戲中使用
而且它可能產生UIKit事件如按下或其他
當你正在玩遊戲你可能沒有興趣
接收這些事件的UIKit版本
如果你設置controllerUserInteractionEnabled
值爲假 在遊戲進行中
然後按下菜單按鈕不會立刻退出你的應用程序
取而代之 你將能夠捕獲它並你自己處理它
但是當用戶返回到遊戲根菜單
你將把值設置爲是
所以按下菜單按鈕能夠退出程序
這就是事件處理
現在讓我們討論下分層圖像
分層圖像是一個用戶界面元素
這是tvOS特有的
你可能在所有演示中看過這些圖像了
它們最多可以有五層圖像
是移動的parallaxing內容
這些是應用圖標需要的
在tvOS上 你的應用圖標至少兩層
你至少需要對該格式有點熟悉
如果你將在tvOS上開發
它們是交互的
當用戶在Siri Remote上移動手指時
圖像會隨着他們的手指移動
這不僅僅是看起來很好看
這幫用戶意識到他們的輸入被實時接收
幫他們預見焦點運動發生的軌跡
它們是動畫
所以他們有很多很棒的內置動畫
特別是當它們獲取聚焦時
我們將展示怎樣才能協調這些動畫
使你的應用變得生動
所以讓我們來討論一下交互
我剛纔播放的視頻是UIImageView
若UIImageView獲得聚焦
它會給你一個很棒的浮動外表
若你有一分層圖像在ImageView裏
但是這是常出現的情況一個UI圖像不是
實際獲得聚焦的控件
圖像通常是較大控件的組件
在這種情況下 較大控件將獲得聚焦
所以怎麼獲取浮動外觀
如果圖像不被聚焦？
它不一定要獲得聚焦
我們已擁有添加至UIImageView的屬性
叫作adjustsImageWhenAncestorfocused
如果你設置它的值爲真
如果任何父圖片視圖獲得聚焦
然後圖像會自動獲得浮動外觀
並開始對用戶的輸入有響應
而且這些圖像也有“按入”狀態
這與一些正常默認值狀態有點不同
它們就在屏幕上
它們有種“壓入”外觀
好像用戶用手壓下一樣
你可以手動觸發它
通過在ImageView設置isHighlighted屬性值
爲真或假 那會產生打開或關閉的效果
你可能想在控件子類裏這樣做
當用戶開始按下選擇按鈕 例如
但有一些情況 我們已爲你考慮到了
你完全沒有必要手動去做這些
這些圖像是在UICollectionViewCells內部
還有圖像在自定義UIButton內部
這些情況下 你完全無需管理isHighlighted屬性
我們會爲你管理它
我們談過了動畫讓我們再進一步瞭解它
當這些圖像形成時發生的事情之一
在浮動外觀裏它們變得更大
或者看起來更大
你可能不得不在毗鄰使用它
你可能把它移開
比如在電影畫報下方你有一個標籤
你可以使用自動佈局去限制這些
所以 若我在此有ImageView
若我改變ImageView大小使其與圖像一樣尺寸
然後你可以限制圖像的邊框
但當它放大 邊框不變
但圖片的可見度會變
所以弄清圖片獲得聚焦時會有多大
我們展示focusedFrameGuide佈局指引
你可以附加其他限制條件到那個佈局指引上
這樣 那些視圖將會離圖像足夠遠
當它們變大時 不會被剪輯
讓我們過一遍這個
我在此有個ImageView並且有個紅色輪廓
它代表UIImageView的框架
當它獲得聚焦時會變大
但是框架依舊在那個紅色輪廓
這個虛線輪廓顯示的就是focusedFrameGuide的位置
那個focusedFrameGuide一直在那裏
即使現在沒有獲取聚焦
你可以選擇其中一個
以附加布局約束
或者你可以選擇改變哪個活躍約束
基於該元素現在是否被聚焦
若你那樣做 你真該使用協調API
那個我們在焦點更新上展示的
確保動畫同系統動畫發生時間一致
系統動畫有很多微妙的東西
比如具體時間
它取決於用戶滑動得多快
或者視圖離屏幕多遠被聚焦
此時它獲得聚焦
所以將目標值放入你的應用是不太可能的
你需要使用協調API
確保你的動畫同系統動畫匹配
向你展示這是如何做到的
我想邀請Randy上臺給你們做個演示
Randy
謝謝你 Justin
今天我將要過一遍這兩個我們經常碰到的情況
關於添加交互至分層圖像
首先我們將看一個UIButton
其次我們將看一下自定義集合視圖表單元
現在開始我有一個在Xcode中已打開的項目
有一個資產目錄 裏麪包含分層圖像
我只有一個...
ViewController子類
我們將要拖拽出一個按鈕——
到畫布
查看它
給它一個圖像
我們將刪除它的標題
接下來我們將加幾個約束條件
讓它垂直和水平居中
接下來我們將更新按鈕框架來匹配這些約束條件
你可以通過下拉菜單來做
但是我通常用鍵盤快捷鍵Command Option Equals
如果你仔細看
按鈕的周圍有一點額外空間
這些是邊緣內容插圖
我們不需要這些 所以可以刪除
這看來差不多是我們想要的
我們將構建和運行並且看看它怎樣運作的
我正用tvOS模擬器 但已將Mac與Siri Remote配對了
對於交互是怎樣工作的你會得到一個較好的認識
我的手指正按下選擇按鈕
但這只是變暗的效果和稍微壓入的效果
當手指移動到數字轉換器上
它對我的觸摸沒有迴應
讓我們做得更好
爲此
我將打開Assistant Editor爲ViewController的子類
爲按鈕拖拽出一個輪廓
在viewDidLoad裏
我將從那個按鈕裏抓取ImageView
我要去打開Justin告訴我們的那個屬性
adjustsImageWhenAncestorFocused
現在如果我構建並且運行
你應該看到按鈕
對在遙控器上的手指作出迴應
當我點擊它的時候 它推進去
但是我們仍然還有一個問題
因爲這個按鈕的邊緣被裁剪了
由於默認
按鈕的ImageView把clipsToBounds打開
我們把它關閉就好
再一次構建和運行
我們應該能夠得到我們想要的結果
交互的分層圖像是非常棒的
它們圍繞着我的手指移動
當我按下它 它就壓入
很好
讓我們來一些更復雜的
我在此還有一個項目
這個項目有CollectionViewController的子類
我繼續
並且配置了CollectionView的尺寸參數
根據tvOS的Human Interface Guidelines
一個六欄位佈局
這些指引告訴我們我想要一個寬度爲250點的單元
我知道 基於我的設計我需要垂直450點
作爲單元的內容
指引告訴我們對於一個六欄位佈局
我們需要水平單元間48點
及垂直單元間至少100點
最後 爲在廣泛TV的安全區域內
我們想在頂部和底部各保留60點離
及左邊和右邊各保留90點
這些數字在指引裏都有
讓我們看下單元本身
我已經給它一個自定義類和複用標識
我們將要放大一點
增加一些...
自定義子視圖
首先我們將拖拽出一個ImageView
然後拖拽出一個標籤
現在我將增加一些限制條件來佈局視圖
我想讓ImageView緊靠左右頂部邊緣
我們恰巧知道我們所有的圖像有相同的寬高比
所以我將添加寬高比限制條件
我將編輯寬高比約束條件
以匹配我們的圖像所以它們的比例是2:3
我將爲我的標籤添加一些限制條件
我從標籤按Control拖拽至ImageView
添加一個水平居中的約束條件
我也想要我的ImageView
我的標籤頂部離ImageView底部有15點
我會在它們兩項之間添加一個約束
現在我們已經添加了這些約束
我們可以執行Command Option Equals
把一切迴歸原位
最後 這個字體有點小
我把它更改成Body風格
不錯的選擇
我們已從海報上的ImageView獲得一些輪廓
我們只要鉤住上面的和標籤
現在讓我們快速瀏覽下CollectionViewController
你可以看到我們剛在這部分執行的項數
以及cellForItemAtindexPath
如果我構建和運行
我應該能得到我們尋找的基本佈局
但是我們將看看行爲是怎樣的
這幾乎是我想要的佈局
全是我想要的
但一下子你說不出哪個項目被聚焦
當我點擊 你看不到我選擇的單元
讓我們來處理這些事情
現在 首先 爲了看到焦點所在我們將進入Interface Builder
選擇我們的ImageView
檢查adjustImagewhenfocused檢查標記
這足以讓我們的單元
開始迴應焦點
如你看到它很大 它對我的觸摸作出反應
當我點擊它 它推進
但是標籤重疊在底部
他們對焦點尺寸變化沒有反應
爲此
我們將打開自定義單元類
在Assistant Editor裏
還有...
首先 我們將拖拽出一個輪廓
爲標籤頂部和ImageView底部之間的垂直約束
我們將爲它添加一個輪廓
我們稱它爲unfocusedConstraint
然後我將添加另外一個屬性
爲focusedConstraint
我們將在awakeFromNib裏設置focusedConstraint
成爲label.topAnchor
與imageView的focusedFrameGuide.bottomAnchor相關
還有那15點
然後在...
updateConstraints
我們將設置focusedFrame
我們將使focusedConstraint爲活躍狀態
當單元獲得聚焦
我們將使unfocusedConstraint爲活躍狀態
在相反的情況下
最後 在didUpdateFocus裏我們將使約束無效
通過調用setNeedsUpdateConstraints
我們將添加一個協調動畫
通過調用addCoordinatedAnimations
在那裏面
我們將調用layoutIfNeeded
這應該夠了現在當我們構建和運行
我們應該看到標籤移動到下方
離開焦點海報
當我從一個移動到另一個
它們全部動畫離開回到它們應該在的地方
很好！
記住 使用focusedFrameGuide和coordinatedAnimations
不要忘記打開adjustsImageWhenAncestorFocused
去獲取這些效果
關於那些 現在交還給Justin
謝謝那很棒的演示 Randy
你可以看到它是多麼的容易
去真正利用獨特的用戶接口元素
真正讓你的tvOS應用變得生動
讓我們說些別的
討論一下滾動條
tvOS上滾動條與iOS上有些不同
它必須間接觸摸
當用戶在iOS上ScrollView裏滾動
它們用肢體觸摸ScrollView
當他們移動手指
ScrollView偏移將會調整
去匹配他們手指的運動
但在tvOS上並非如此
在tvOS上你並不是在觸摸屏幕
也不是直接操控滾動視圖
你真正做的是改變焦點項目
當焦點項目改變焦點引擎會檢測到它
它會自動滾動到它需要的任何滾動視圖
確保焦點視圖總是在屏幕上
焦點引擎會選擇它能夠調整的最佳偏移
基於視圖的尺寸和滾動視圖的尺寸
但也有時候你想控制
它將發送給你什麼樣的偏移
例如 一個人們常用的自定義
是他們想要焦點視圖始終居中
在ScrollView的邊界內
你可以那樣做
你可以那樣做的方法是使用UIScrollViewDelegate方法
你有可能從iOS中識別
那是scrollViewWillEndDragging:withVelocity:targetContentOffset
那裏最終的參數targetContentOffset
是一個指針指向CGPoint
那個指針代表偏移
焦點引擎將滾動到的地方如果你什麼也不做
那個是偏移它會自動爲你展示
但是如果你願意自己計算
滾動偏移是多少
你也可以那樣做
計算你想要的偏移
把它的值存在指針中
讓指針指向你
焦點引擎將滾到那裏
伴隨着它你會得到很多很棒的系統動畫
對於你所選擇的偏移
但是並不是說直接操控總是不好的
或者在tvOS上從來不是個好主意
有些情況下 你想這樣做
所以 一些情況下需要
比如你有許多全屏內容
可能是一個全屏相片集
那裏照片可以完全覆蓋到屏幕邊緣
一個UIKit的例子是UIPageViewController
當你有一個UIPageViewController它並不做焦點滾動
取而代之 你直接操控
PageViewController的ScrollView內容
還有其他情況下 你有很多滾動文本
這是你想直接操控的另外一處
基本上 不清楚焦點項目是什麼時
你不能夠看到下一個焦點項目是什麼
這些都是非常適合直接操控的情況
如果你想要那樣做
你沒必要去寫你自己的手勢處理代碼
你可以複用早已存在於ScrollView的拖動手勢
這個技巧是滾動視圖是被配置成
直接觸摸的唯一監聽
Siri Remote正生成間接觸摸
你只需獲得這個拖動手勢識別器
確認它監聽間接觸摸
我們也有定向按下手勢識別器
只有tvOS的ScrollView上纔有
它是監聽這些箭頭按鈕按下事件
用戶不使用設備的情況下
可以觸摸輸入也可以滾動ScrollView
這個手勢默認是禁用的
因爲我們更傾向於讓這些箭頭按下操控焦點
而非操控ScrollView偏移
你需要啓用它
你可以使用這段代碼去做這兩個事情
我們從ScrollView中得到panGestureRecognizer
我們告訴它我們想監聽間接觸摸事件
我們得到directionalPressGestureRecognizer
告訴它應該是打開的
如果你這樣做 所有進入ScrollView的這些事件
會直接操控ScrollView偏移
其實 合併直接操控技術
和焦點交互技術是可能的
爲了展示如何去做
我想邀請Kevin上臺演示
Kevin
謝謝 Justin
嗨 我是Kevin Hiscott我是tvOS工程師
我們將看一個關於視圖控制器的例子
在文本視圖中展現條款和條件文本
TextView是ScrollView的子類
我們可以看到怎麼樣向它添加直接操控
我們去看下我的ZIB看看我目前爲止設置了什麼
我有個文本視圖帶有冗長的Lorem Ipsum粘貼在裏面
如果我們進入應用程序
我們可在應用的上下文中看到它的樣子
展現ViewController時
我們可以沿着底部的邊緣文本看到其實文本已被裁剪
若我努力擦碰Siri Remote文本不會滾動
讓我們來改進它
讓我們進入ViewController
在viewDidLoad裏抓取我爲UITextView創建的輪廓
我稱它爲messageTextView
在messageTextView和任何ScrollView上有一個panGestureRecognizer
我們將改變它允許的觸摸類型
包括間接觸摸的類型
如Justin所說
這些觸摸由Siri Remote創建
我們還將把isSelectable的值設置爲真
這將允許文本視圖獲得聚焦
和接收這些事件
讓我們構建和運行看看它們怎樣運作
呈現ViewController時
其實我能夠直接擦碰
通過Siri Remote使文本上下滾動
很好 直接操控
另一個ViewController所需的好條款和條件
是讓用戶接受或拒絕你條件的方法
爲此 讓我們看看我的ZIB
拖入幾個按鈕
我將一個標識爲不同意
另一個標識爲同意
讓我們構建和運行看看將發生什麼
我期待發生的是我們的焦點
伴隨着水平擦碰而作水平移動
對於垂直擦碰卻始終滾動文本視圖
但當我呈現ViewController
我可以看到那些垂直擦碰確有移動文本
但是 如果我擦碰得太低
焦點實際移動到按鈕上
我就不能滾動文本了
直到焦點回到文本視圖
這並非我想要的行爲
讓我們回到我的ViewController
我們將禁用isSelectable
我們實際上不是想讓TextView成爲一個可獲聚焦的屏幕元素
取而代之 我將展示一個小技巧
我們將抓取panGestureRecognizer
實際上把它添加到我們的ViewController視圖
這將允許消息TextView
本身不獲聚焦的情況下 接收事件
讓我們構建和運行看看它的表現
呈現ViewController時
我們可以看到不同意按鈕立刻獲得聚焦
這是因爲文本視圖已經不可獲聚焦了
我可左右擦碰Siri Remote去移動焦點
但任何時候我可以上下擦碰去移動文本
很好 這樣看起來不錯
在tvOS上 我們最後一個要考慮的
是由其他輸入方法產生的定向按下類型事件
像遊戲控制器鍵盤 或者IR遙控器
我們讓tvOS很容易支持這些
讓我們回頭看看我的視圖控制器
我們將抓取directionalPressGestureRecognizer
從我們的messageTextView中並且啓用它
伴隨着這些類型而允許滾動發生
由其他設備生成
我們將要做的最後一件事是
把GestureRecognizer移動到我們自己的視圖中
如我們之前做的
讓我們構建和運行看看整體運行情況
現在當我呈現條款和條件的時候
我能夠左右擦碰去移動焦點
我也能夠左右拍擊去移動焦點
通過定向按下類型事件由Siri Remote
和其他設備生成
我可以上下擦碰去改變內容偏移
但是我也可以上下拍擊去增量滾動
很好！這是一個全功能條款和條件的ViewController
在tvOS中
謝謝你們
我已迫不及待接受你們應用裏的所有條款和條件
交還給Justin
讓我們來繼續最後一個話題 文本輸入
我們在tvOS上有很棒的系統鍵盤
有很多特性只可用在
系統鍵盤上
我想和你們介紹一下幾個特性
其中一個功能是聽寫
用戶可對Siri Remote說話
文字會顯示在屏幕上
我們還支持Bluetooth鍵盤
若將其和Bluetooth鍵盤配對你就可以直接在那裏打字
我們有新的AppleTV Remote應用
因此用戶可以把電話與TV配對
他們可以在電話鍵盤上打字
發送文字到TV
這裏還有很多本地化的細節
系統鍵盤會爲你處理好
它能夠自動改變自己的佈局
根據用戶正使用的輸入設備
這裏有一個你可能最熟悉的線性佈局
但還有我們將會用到的網格佈局
如果沒和TV配對的Siri Remote
有很多很棒的功能
它們只有在系統鍵盤裏是可用的
如果你使用的不是系統鍵盤
用戶將不能夠使用這些功能
我們不鼓勵你推出自己的鍵盤
堅持用系統鍵盤
用戶可以使用所有這些功能
它們全部只對系統可用
這裏有些方法你可以自定義
內置的系統鍵盤
其中一個方法是添加一個你自己的視圖
到鍵盤上會呈現在它旁邊
你可使用UIResponder上的一些API
那些你有可能從iOS中識別
這裏有inputAccessoryView
和inputAccessoryViewController
如果你在文本框上指派這些屬性
你想去編輯文本的文本框
當鍵盤出現
在鍵盤的旁邊展現你自己的視圖
一秒後 我將展現剛纔那一幕的截屏
最後 我想指出行爲的一個變化
出現在tvOS 9和tvOS 10間
UITextField有一個屬性叫keyboardAppearance
你可以設置它爲不指定亮和暗
在tvOS 9上 如果你設置它比如 暗
然後鍵盤呈現時 不僅自身變暗
屏幕上的文本框同樣會變暗
現在tvOS 10裏我們有新外觀API
所以整個系統能夠對應的變亮或變暗
現在我們在tvOS 10上做的
是這個鍵盤外觀屬性隻影響鍵盤
和文本框外觀
它將被更大的UPI Tray Collection所制定
這是我答應展示給你們的屏幕截圖
這種情況下我已經創建了一個常規文本框
我給它一個inputAccessoryView
我放了一個紅色邊控在上面 所以你可以看到它在哪裏
這些UI標籤全部都是定製的
我只是把它們放在那裏所以你可以添加任何種類的附件視圖
那些你想讓它們出現在鍵盤上方的
另一個你可在鍵盤上獲得UI方法
同時當鍵盤正使用SearchController
你使用一些從iOS中能識別的API
這就是UISearchController
我們有鍵盤並且搜索結果呈現在其下方
這也是自動適配的
這裏有基於網格和基於線性的佈局
取決於用戶正在使用的輸入設備
你可以把它嵌入到其他視圖類型的內部
SearchController通常要模態展現
並接管整個屏幕
但你可把它嵌入到另一個視圖控制器中
通過使用UISearchContainerViewController
我將在幾頁幻燈片裏展現一段樣本代碼
你提供了爲搜索結果定製的視圖控制器
搜索結果的視覺外觀
和交互完全取決於你
你可以做任何你想做的
你可能使用一個視圖集合或可能使用一個分開視圖
它有一個表視圖和集合視圖
其他你想要的
取決於你來定製視圖控制器
很快地展示一下如何在其他東西內部嵌入一個搜索控制器
比如 一個標籤欄控制器
我獲取到我的定製類ViewController
在viewDidAppear裏我將創建一個searchController
我想確保不做第二回
所以我檢查確保我之前沒有做過
然後我創建了UISearchController
告訴它我的結果使用何種視圖控制器
當搜索查詢變更時 與誰聯繫
然後我要去包裹那些
UISearchContainerViewController內部的東西
現允許我拿這個container
我可以在其上面做常規的ViewController containment
我將它作爲一個ChildViewController添加
如果你想這樣做
你將會很容易在標籤欄內部使用搜索控制器
如在tvOS上的一些系統應用程序
這就是文本輸入
總的來說
我們希望你們能從本次演講中得到的東西之一
首先是當你正處理菜單按鈕 小心
記住你不想去幹擾系統手勢
當你正使用分層圖像時
利用我們提供給你的佈局指引
和協調動畫API
確保你的視圖能夠移動
與系統動畫協同運作
若你想在ScrollViews上直接操控
你無需自己做任何處理代碼的事情
只要複用已經內置的拖動手勢
最後 使用系統鍵盤去確保
你的用戶能獲得使用
所有的功能 當他們輸入文本的時候
想獲取本次演講更多的信息你可以訪問這個URL
這裏你會找到文檔的鏈接
本週接下來還會有其他演講
我想特別推薦兩個
都是關於tvOS上的UIKit
希望大家在餘下的會議中過得愉快 謝謝