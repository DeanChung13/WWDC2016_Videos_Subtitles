你好 歡迎參加“開發CarPlay系統”的第一場會話
我是EmilyApple汽車體驗工程師
CarPlay 的設計理念是讓你可以在車內更智能安全地使用iPhone
CarPlay使你在駕駛時可以使用iPhone完成事情
並把它們顯示在車載系統上
CarPlay 將iPhone 熟悉的界面元素和交互模式帶進了你的車中
用戶已經知道怎麼使用CarPlay
因爲他們知道使用iPhone
CarPlay不僅在汽車上顯示iOS
CarPlay完全和你的汽車自帶的系統整合
帶來最好的用戶體驗
CarPlay允許你爲未來設計
有了CarPlay你可在今天製造一輛車
當Apple發佈新版本的iOS時
用戶可以馬上享受新特性帶來的好處
你的車在未來的幾年內都能保持良好
今天我們會帶你瀏覽CarPlay的功能如何工作
並討論你要考慮的最重要的要求
我們想要解釋我們希望CarPlay能帶來的用戶體驗
和我們提供的設計指南
最後要談論CarPlay支持的應用
iPhone用戶界面設計地非常完美
當拿在手上時 當你可以觸摸它時
CarPlay將用戶界面帶到車上
使它更適應這種設置使用更安全
它和你車上已有的一起工作
它在這個環境下用起來很舒服
讓我們開始談論CarPlay如何工作的細節
讓我們從汽車的原生用戶界面開始
當iPhone被插入時
CarPlay會話開始
當CarPlay會話建立後
信息通過協議雙向傳輸
視頻可以從iPhone傳到車裏
音頻也可以
音頻還可以從車上的麥克風傳給iPhone
一旦CarPlay會話建立了
不同的數據流的組合會被使用
當CarPlay主屏被第一次顯示而且沒有音頻在播放
傳輸協議被用作初始化和定位信息
主屏顯示的一個H264視頻流
從iPhone傳送到車上
若接着在CarPlay裏播放音頻
這個傳輸協議會被用來
傳送當前播放的音軌的信息
這個視頻流在編碼正在播放屏幕
這首歌的音頻被髮送給汽車
如果CarPlay UI退出了汽車的屏幕正在顯示
CarPlay會話還是保持活動
傳輸協議繼續被使用
爲正在播放和位置信息
視頻流不再被需要
但是CarPlay音頻仍然在播放
即使CarPlay視頻沒有顯示
屏幕和音頻被分開控制
來自原生系統的視頻
可在CarPlay的音頻播放時顯示
如果CarPlay界面被顯示
來自原生系統的音頻比如收音機 可以播放
讓我們看看Siri啓動時會發生什麼
使用方向盤上的一鍵通按鈕
傳輸協議被用來告訴主機
iOS語音識別要被啓用
CarPlay UI被髮送到屏幕
Siri音頻鳴響在汽車音響上播放
這個情況下音頻也從汽車麥克風
傳送給iPhone
這個例子給你一個CarPlay如何工作的高層次的概覽
我們看看主機發生了什麼的細節
通過線纜連接的CarPlay數據通過USB傳輸
所有數據用IP打包
除了iAP2傳輸協議
來自汽車傳感器的信息通過iAP2傳輸
比如音頻 電話 導航數據元
這個傳輸插件是Apple提供的源碼
它接收輸入的視頻和音頻流
以及一個額外的傳輸流
音頻和視頻被髮送給主機的設施
連接到音響 麥克風和屏幕
控制事件來自觸摸屏 旋鈕
按鈕 觸摸板被髮送給這個插件
如果是無線連接的CarPlay系統的大部分是一樣的
Wi-Fi和Bluetooth均需
對於無線連接所有數據被用IP打包
用同樣方式連接汽車子系統
你現在對CarPlay如何工作有了一定理解
我們來看看最重要的汽車要求
我們會談論它們的細節
我們希望確定你瞭解了這些要求
在你開始設計系統前
你可以確保它支持CarPlay
首先汽車要有一個好的顯示屏
一個高質量的顯示屏對CarPlay的體驗很關鍵
一些標準分辨率被支持
這是那些分辨率
大部分是近似於16比9
特別寬的屏幕也被支持
目前所有支持的分辨率都是橫向
我們支持不同像素密度的屏幕
CarPlay的圖標尺寸經過了調整
根據屏幕分辨率
所以圖標會在低和高分辨率上呈現相同的大小
不然的話在720p的屏幕上圖標會小很多
如果你的屏幕的分辨率有些許不同
和這裏列出的相比聯繫Apple來查詢它是否被支持
我們要求在零件市場屏幕不小於6英寸
因爲零件市場中的系統可以安裝到很多汽車上
汽車廠商生產的系統沒有最低要求
因爲汔車廠商有責任
確保CarPlay可以正常的顯示在所選的汽車屏幕上
我要指出一些額外的屏幕要求
24位的色深
60赫茲的刷新頻率是強烈推薦的
對一個響應好的用戶界面
確保H264解碼器支持正確的配置
這是一個硬性要求
高品質的顯示屏對CarPlay體驗至關重要
讓我們談談汽車的音頻系統和麥克風
CarPlay音頻被分成2個流
主音頻和備用音頻
主音頻是雙向的用作音樂和其他媒體
以及通話和Siri
備用音頻被用作通知
主機把它和主音頻混合
如果主機正在播放音頻
像是收音機 主機必須混合備用音頻
從iPhone發來的音頻
有線連接CarPlay使用LPCM
無線CarPlay需要壓縮音頻
媒體使用AAC-LC你可以選擇使用OPUS
和AAC-ELD在其他音頻上
CarPlay支持車上的多種用戶輸入設備
CarPlay UI可以用主機上的觸摸屏來控制
通話旋鈕和按鈕或者觸摸板
方向盤上的Siri按鈕也是關鍵的用戶輸入設備
很多車有觸摸屏 讓我們先談談它
當CarPlay UI被激活而且用戶觸摸屏幕
主機發送給iPhone
觸摸的x和y座標
主機發送所有的觸摸給iPhone
當CarPlay顯示在屏幕上時
CarPlay只支持單擊
我們支持兩種觸摸屏
高保真和低保真
高保真觸摸系統有低延遲
所以允許追蹤用戶手指來支持滑動手勢
然而這要求高性能的系統
有少於140毫秒的觸摸延遲
這是列表通過滑動手勢滾動
追蹤觸摸輸入工作在高保真觸摸系統上
低保真觸摸屏可能有更高延遲
通常是電阻屏
點擊可以控制UI但是滑動不會追蹤用戶的手指
這是用點擊來滾動列表是怎麼工作的
在低保真觸摸系統上
有一些汽車用旋鈕 按鈕和觸摸板來控制
有時它們是主要的用戶輸入設備
有時有輔助的觸摸屏
CarPlay支持所有的組合
旋鈕被主機支持發送旋轉
選擇
和後退事件
這是需要支持的最小的特性集合
對被用作主要界面的旋鈕
旋轉 選擇 後退
有些旋鈕還支持傾斜或輕推功能
這被CarPlay UI支持
汽車觸摸板報告x和y座標
和選擇
還有後退按鈕
如果旋鈕和觸摸板控制器是主控制器
後退和選擇是必須的
輔助觸摸板還可以支持字符識別
按鈕提供多種功能比如下一個 上一個
電話功能是可選的
CarPlay UI會自動改變
來匹配車上可用的用戶輸入設備
所有組合都有可能
如果主操作界面是觸摸屏
組合包括有旋鈕
有觸摸板 或者有旋鈕加觸摸板都是可能的
必須有一個爲了Siri的物理按鈕
Siri對CarPlay體驗很重要
用戶需要一個快速的方法訪問Siri
即使CarPlay UI沒有被顯示
通常這個要求被實現
通過方向盤上的一鍵通按鈕
關於Siri按鈕 我們要求主機發送給iPhone
所有按鈕的按下 鬆開事件
所以在Siri會話中的互動成爲可能
這就是我們對用戶輸入的討論
傳感器信息對CarPlay很重要
CarPlay需來自汽車的位置信息
這樣地圖應用才能正常工作
可以提供速度和GNSS信息
每輛車都需要知道它的速度
速度信息被iPhone用來推算定位
很關鍵 如果汽車沒有
一個GPS或者GLONASS接收器
GNSS信息包括經緯度
如果汽車有這個功能
來自汽車的衛星定位信息
和iPhone自己的傳感器都被使用
來判斷用戶的位置
來自汽車的數據可能更好
因爲汽車可以集成更大的天線
這是推薦的配置
這會帶來最好的地圖用戶體驗
發送衛星定位信息給iPhone是必須的
如果汽車有這些技術
GNSS信息也是必須的如果任何系統
要支持無線CarPlay
因爲更有可能手機在口袋 包
或者其他地方手機本身的信號很差
連接iPhone和主機的要求是什麼？
Apple CarPlay支持有線和無線連接
我們很高興能提供無線CarPlay
因爲這給用戶帶來方便的體驗
用戶可以把手機留在口袋或包裏
對短途的駕駛特別方便
讓我們首先談談有線連接
在這用USB 所有的音頻和視頻
以及控制信息都通過USB傳輸
你的主機需要支持USB角色互換
主機將會從USB主機切換成USB設備
高吞吐率是必須的
你要確保你的USB設備
支持要求的數據速率
如果你的車上有多個USB接口
而且不是所有的都支持CarPlay
你可能要給接口加標籤
無線CarPlay在iOS 9裏被支持
要求有Bluetooth和Wi-Fi
Bluetooth被用來發現和初始化連接
一旦Wi-Fi證書被通過Bluetooth發送iPhone
Wi-Fi就被連接了
Bluetooth連接斷開
之後的CarPlay傳輸都會通過Wi-Fi
在CarPlay會話中所有音頻
包括通話 音頻和視頻通過Wi-Fi傳輸
還有控制協議
CarPlay要求一個通過認證的Wi-Fi接入點
推薦5GHz
請注意高吞吐率 每秒25兆比特是必須的
Bluetooth子系統需要支持傳輸協議
無線CarPlay提供方便舒適的用戶體驗
我們很高興看到你的汽車支持它
現在讓我們從Donald這聽聽CarPlay的設計指導
嗨 我叫Donald我在Apple從事設計工作
現在你看過了CarPlay怎麼工作
讓我們看看一些設計指導能幫助你提供
你的汽車中最好的CarPlay體驗
CarPlay設計成使用整個顯示屏
最重要的事情之一
是CarPlay設計成使用整個屏幕
iPhone的用戶立即熟悉CarPlay且對它感到舒服
因爲這是一個一致的系統有自己的圖標
視覺語言 內部瀏覽系統
和CarPlay互動都很容易很快速
當用戶可以確信屏幕上的任何東西都是CarPlay的一部分
如果用戶需要分辨什麼元素是CarPlay的一部分
什麼元素是你的汽車用戶界面的一部分
那麼所有的交互都變得更有挑戰性
而且你汽車的原生用戶界面可能包括
圖標和CarPlay圖標有相似功能
若這些圖標同時出現在屏幕上會使人困惑
所以要用整個屏幕來顯示CarPlay
讓我們看看當CarPlay開始時應該發生什麼
第一次連接iPhone
CarPlay總在你的iPhone插入汽車時啓動
用戶永遠都不需要思考如何啓動它
當用戶第一次連接他們的iPhone到汽車上時
汽車的顯示屏應該馬上切換成顯示CarPlay
這一點說明CarPlay啓動後
在用戶的連接行爲與令人熟悉的CarPlay界面之間創造了強聯繫
不要顯示通知來公告CarPlay狀態的改變
CarPlay出現在屏幕上
就是最有效的視覺反饋
再一次連接到iPhone
讓我們看看CarPlay的初次連接之後應該發生什麼
當用戶第二次連接iPhone
應該感覺像是繼續他們之前的會話
若CarPlay在用戶離開汽車前顯示在屏幕上
CarPlay應在iPhone連接後重新顯示在屏幕上
如果CarPlay媒體當用戶離開時在播放
CarPlay媒體當iPhone連接時應該繼續播放
只要用戶沒有選擇其他的音頻來源
在CarPlay連接之間
我們應該永遠尊重用戶上次在車裏進行的選擇
讓我們看看上次用戶模式應該如何工作
請注意我在使用CarPlay它顯示在顯示屏上
現在如果我斷開連接
CarPlay結束 汽車回到它的原生用戶界面
如果我再插上
CarPlay應該出現在屏幕上因爲這是我上次在車上做的事情
如果CarPlay是連接斷開時出現在屏幕上的
或者汽車被關閉時CarPlay應在iPhone重連時顯示
若CarPlay媒體當時在播放CarPlay應重新播放
讓我們看一個不同的例子
CarPlay當汽車顯示原生用戶界面時是激活狀態
現在如果它斷開連接然後重新連接
CarPlay不會出現在屏幕上
因爲原生用戶界面是我在車上使用的最後一個東西
若CarPlay不是最後顯示的東西
應該繼續顯示車自己的用戶界面
但即使CarPlay不是最後顯示在屏幕上的
若CarPlay媒體當時在播放CarPlay媒體應繼續被播放
切換到和從CarPlay顯示
當用戶將手機插入到車上時CarPlay界面就顯示出來了
但是用戶可以隨時在CarPlay界面與原生用戶界面之間切換
我們早看到 用戶回到汽車的用戶界面
通過選擇品牌的圖標在CarPlay主屏上
他們可切換回CarPlay通過使用Apple CarPlay按鈕
Apple CarPlay按鈕是最重要的提示
CarPlay存在
一旦CarPlay啓動
Apple CarPlay按鈕必須在頂級菜單中激活
且Apple CarPlay應只在iPhone連接時出現
而且CarPlay被激活
確保iPhone連接斷開時隱藏Apple CarPlay按鈕
顯示Apple CarPlay按鈕
是啓用的狀態當CarPlay激活時
是禁用狀態當CarPlay沒有激活時
你可選擇替換一個頂層菜單中的已有按鈕
替換成Apple CarPlay按鈕比如電話按鈕
請記住Apple CarPlay按鈕必須出現在你汽車的主屏中
當iPhone連接上的任何時候
當iPhone斷開連接時
Apple CarPlay按鈕必須消失或禁用
Apple CarPlay按鈕變種
讓我們談談應當出現的你的界面中的Apple CarPlay按鈕
有些被批准AppleCarPlay商標可以使用
在你的原生用戶界面中作爲按鈕
選擇一個最適合你的設計的
有一個黑色商標和一個白色商標
還有白色黑色背景的變體
最後還有彩色背景
媒體源
讓我們談談當iPhone斷開連接時怎麼處理媒體源
若CarPlay被激活
用戶正在聽CarPlay音頻播放
當iPhone連接斷開時是很可能表明
他們要離開車
你的系統應該優雅地處理CarPlay媒體被斷開
當iPhone斷開連接時用戶不應該聽到任何聲音
音頻不應該回到另一個音頻源
若iPhone是在CarPlay顯示在屏幕上時斷開
你應該回到進入CarPlay前的最後一個屏幕上
不要顯示CarPlay不可用或者設備斷開屏幕
當CarPlay媒體在播放時
而且用戶斷開iPhone他們不應該聽到任何聲音
按鈕的支持
你車上的硬件按鈕應該也支持CarPlay
Siri是CarPlay的必需部分它要求一個觸覺反饋按鈕
因爲它如此重要這個按鈕必須在方向盤上
用戶希望Siri在任何時候都工作
無論CarPlay是否在顯示屏上可見
他們還希望Siri按鈕像iPhone主畫面按鈕那樣工作
按下並保持600毫秒開啓動Siri
啓動的延遲不能超過1秒
汽車的媒體按鈕應該連接CarPlay的媒體播放
這樣用戶可以播放 暫停切換到下一首或上一首音軌
快速前進後退
最後 如果你的車有針對電話媒體 導航的快捷鍵
它們也應該映射到CarPlay中相應的應用上
現在讓我們談談CarPlay中可以運行的應用
CarPlay支持的應用會出現在汽車屏幕上的CarPlay主屏中
支持3類應用
音頻 針對特定車輛的和消息應用
如果用戶有一個音頻應用爲了CarPlay做了更新
這個應用會出現在用戶連接到的所有CarPlay汽車上
這些應用的用戶界面是固定的
有iOS提供的結構
內容由應用自己提供
我們注意到音頻應用看起來很像內置的音樂應用
用戶選擇想要聽什麼通過一個基於列表的UI
現在播放屏幕顯示合適的內容和控制
這個應用需要有一個特殊的授權
來兼容CarPlay
我們在iOS 10中做了改進使音頻應用的體驗更好
iOS 10中新增了標籤頁支持
使得瀏覽列表組織更容易
在現在播放屏幕中你可以看到應用的名字
和額外的播放控制按鈕
在列表視圖中你可以看到正在播放什麼
什麼可以被串流
明確的或直播流媒體
一些應用被設計成它們一開始運行就播放音頻
我們在iOS 10中加入了對這些應用的支持
這些加起來顯著提升體驗
看看這個新的標籤頁
串流應用的雲圖標
以及如何顯示什麼正在被播放
在正在播放屏幕中
這是應用名
和額外的播放控制
讓我們看看下一類別
專門針對特定車輛開發的應用
由汽車製造商發佈的應用被用來控制車輛的功能
或者提供車輛信息
它們只出現在那家制造商的特定車型中
這些應用也需要CarPlay授權
Siri支持是iOS 10新特性
針對控制車輛功能的製造商應用
Siri現在內置了支持可以改變收音機節目
改變空調 等等
製造商應用和汽車通訊來實現這些功能
在Siri告訴應用用戶想做什麼之後
讓我解釋製造商應用是怎麼只在支持它們的車上運行的
一個CarPlay主屏的應用圖標被啓用
只當iPhone連接到主機
主機支持和應用有相同名字的協議
主機支持的協議名和應用名要匹配
iAP外部附屬
被用來從應用向主機傳輸數據
主機可以申明多個協議名
來支持當前和以後的應用
針對不同組的目標車型
主機應該有一個協議名來匹配所有這個品牌的汽車
比如com.brand
他們還應該用協議名來匹配有特定功能的車
比如電動車或運動款
還應該包括針對特定車型的協議名
這樣只針對那款車型的應用
在將來可以被髮布
主機需要用iAP2
來申明至少一個支持的外部附屬協議
一般會多於一個
必須支持外部協議會話的開始和停止
外部附屬協議CarPlay須設爲真
如果汽車支持有線和無線連接CarPlay
iAP2消息在所有傳輸方式上都要被實現
大部分製造商應用會和汽車通訊來完成任務
像是改變空調
這些應用還需要設計和實現一個傳輸協議
那麼應用如何支持這些特性？
應用的Entitlements.plist需要被修改
來包括協議名
匹配那些目標主機像這裏顯示的這樣
有了這些額外的東西加上用來和車輛通訊的協議
和CarPlay授權
你的應用就爲CarPlay準備好了
我們希望看到一些來自制造商的優秀的CarPlay應用
CarPlay和iOS 10支持一類新的應用
消息應用
當消息應用被更新以支持CarPlay
那個應用會顯示在CarPlay主屏
可以收發消息
被Siri互動驅動
我們很高興把CarPlay的功能擴展到消息應用
使體驗更聰明更安全
我們希望這是對CarPlay的一個有用的概覽
CarPlay是個很好的辦法來保持用戶體驗
在車上的體驗 可以長久保持新鮮
我們很高興有這個機會爲你們演講
關於iOS 10的新特性
想知道更多信息請查看這次會話的 WWDC 網址
我們還有後續深入瞭解CarPlay的視頻會話你可能會感興趣
謝謝觀看